<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directional Compass</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        .compass-container { position: relative; width: 200px; height: 200px; margin: 50px auto; }
        .compass { width: 100%; height: 100%; }
        .needle {
            position: absolute; top: 50%; left: 50%;
            width: 10px; height: 100px; background: red;
            transform-origin: 50% 90%; transform: translate(-50%, -90%) rotate(0deg);
        }
    </style>
</head>
<body>
    <!-- <h1>Compass to Target</h1> -->
    <p id="status">Getting location...</p>
    <p id="angle"></p>
    <div class="compass-container">
        <img src="compass.png" class="compass" alt="Compass">
        <div class="needle" id="needle"></div>
    </div>
    <script>
        const targetCoords = { lat: 37.7749, lon: -122.4194 }; // Example: San Francisco

        function getBearing(lat1, lon1, lat2, lon2) {
            const toRad = deg => deg * Math.PI / 180;
            const toDeg = rad => rad * 180 / Math.PI;

            const dLon = toRad(lon2 - lon1);
            const y = Math.sin(dLon) * Math.cos(toRad(lat2));
            const x = Math.cos(toRad(lat1)) * Math.sin(toRad(lat2)) - 
                      Math.sin(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.cos(dLon);
            return (toDeg(Math.atan2(y, x)) + 360) % 360;
        }

        function updateNeedle(userHeading, targetBearing) {
            const rotation = (targetBearing - userHeading + 360) % 360;
            document.getElementById("needle").style.transform = `translate(-50%, -90%) rotate(${rotation}deg)`;
            document.getElementById("angle").textContent = `${rotation} degrees`;
        }

        navigator.geolocation.watchPosition(position => {
            const { latitude, longitude } = position.coords;
            document.getElementById("status").textContent = `Your Location: ${latitude.toFixed(5)}, ${longitude.toFixed(5)}`;

            const targetBearing = getBearing(latitude, longitude, targetCoords.lat, targetCoords.lon);

            window.addEventListener('deviceorientation', event => {
                if (event.alpha !== null) {
                    updateNeedle(event.alpha, targetBearing);
                }
            });
        }, error => {
            document.getElementById("status").textContent = "Unable to get location.";
        });
    </script>
</body>
</html>
